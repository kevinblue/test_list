/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.56
 * Generated at: 2017-03-26 01:41:36 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.WEB_002dINF.jsps.solutions.leasing.common.templateManager;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;

public final class editword_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n");
      out.write("<form id=\"form1\" action=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/leasing/template/uploadEidtFile.action\" enctype=\"multipart/form-data\" style=\"padding:0px;margin:0px;\">\r\n");
      out.write("<input name=\"fileid\" id=\"id_fileid\" type=\"hidden\" value=\"");
      out.print( request.getParameter("id"));
      out.write("\" />\r\n");
      out.write("<div id=\"officecontrol\">\r\n");
      out.write("   <div id=\"id_officeheight\">\r\n");
      out.write("       <script language=\"javascript\" type=\"text/javascript\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/ntko/officecontrol/ntkoofficecontrol.js\"></script>\r\n");
      out.write("   </div> \r\n");
      out.write("   <div id=statusBar style=\"height:20px;width:100%;background-color:#c0c0c0;font-size:12px;\"></div>\r\n");
      out.write("<script language=\"JScript\" for=NTKO_OCX event=\"OnDocumentClosed()\">\r\n");
      out.write("     setFileOpenedOrClosed(false);\r\n");
      out.write("</script>\r\n");
      out.write("<script language=\"JScript\" for=TANGER_OCX event=\"OnDocumentOpened(TANGER_OCX_str,TANGER_OCX_obj)\">\r\n");
      out.write("                                   SetReviewMode(true); //修改留痕\r\n");
      out.write("\t\t\t\t\t                if(status!=\"2\"){\r\n");
      out.write("\t\t\t\t\t\t\t\t       setFileNew(false);  //禁止新建\r\n");
      out.write("\t\t\t\t\t\t\t\t       setFileOpen(false);//禁止打开文件\r\n");
      out.write("\t\t\t\t\t\t\t\t       setFileSaveAs(false);//禁止另存为\r\n");
      out.write("\t\t\t\t\t\t\t\t       OFFICE_CONTROL_OBJ.SetReadOnly(true,\"123\");//禁止编辑\r\n");
      out.write("\t\t\t\t\t\t\t\t       OFFICE_CONTROL_OBJ.Menubar=false;\r\n");
      out.write("\t\t\t\t\t\t\t\t\t   OFFICE_CONTROL_OBJ.ToolBars=false;//菜单不显示\r\n");
      out.write("\t\t\t\t\t\t\t\t\t   OFFICE_CONTROL_OBJ.activeDocument.saved=true;//saved属性用来判断文档是否被修改过,文档打开的时候设置成ture,当文档被修改,自动被设置为false,该属性由office提供.\r\n");
      out.write("\t\t\t\t\t                }\r\n");
      out.write("\t\t\t\t\t\t\t\t\t//获取文档控件中打开的文档的文档类型\r\n");
      out.write("\t\t\t\t\t\t\t\t\tswitch (OFFICE_CONTROL_OBJ.doctype)\r\n");
      out.write("\t\t\t\t\t\t\t\t\t{\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\tcase 1:\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileType = \"Word.Document\";\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileTypeSimple = \"wrod\";\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\tcase 2:\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileType = \"Excel.Sheet\";\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileTypeSimple=\"excel\";\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\tcase 3:\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileType = \"PowerPoint.Show\";\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileTypeSimple = \"ppt\";\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\tcase 4:\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileType = \"Visio.Drawing\";\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\tcase 5:\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileType = \"MSProject.Project\";\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\tcase 6:\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileType = \"WPS Doc\";\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileTypeSimple=\"wps\";\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\tcase 7:\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileType = \"Kingsoft Sheet\";\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileTypeSimple=\"et\";\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\tdefault :\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileType = \"unkownfiletype\";\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\t\tfileTypeSimple=\"unkownfiletype\";\r\n");
      out.write("\t\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t\tsetFileOpenedOrClosed(true);\r\n");
      out.write("\t\t\t\t\t\t\t\t</script>\r\n");
      out.write("\t\t\t\t\t\t\t\t\t<script language=\"JScript\" for=TANGER_OCX event=\"BeforeOriginalMenuCommand(TANGER_OCX_str,TANGER_OCX_obj)\">\r\n");
      out.write("\t\t\t\t\t\t\t\t\talert(\"BeforeOriginalMenuCommand事件被触发\");\r\n");
      out.write("\t\t\t\t\t\t\t\t</script>\r\n");
      out.write("\t\t\t\t\t\t\t\t<script language=\"JScript\" for=TANGER_OCX event=\"OnFileCommand(TANGER_OCX_str,TANGER_OCX_obj)\">\r\n");
      out.write("\t\t\t\t\t\t\t\t\tif (TANGER_OCX_str == 3) \r\n");
      out.write("\t\t\t\t\t\t\t\t\t{\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\talert(\"不能保存！\");\r\n");
      out.write("\t\t\t\t\t\t\t\t\t\tCancelLastCommand = true;\r\n");
      out.write("\t\t\t\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t\t\t\t</script>\r\n");
      out.write("\t\t\t\t\t\t\t\t<script language=\"JScript\" for=TANGER_OCX event=\"AfterPublishAsPDFToURL(result,code)\">\r\n");
      out.write("\t\t\t\t\t\t\t\t\tresult=trim(result);\r\n");
      out.write("\t\t\t\t\t\t\t\t\tdocument.all(\"statusBar\").innerHTML=\"服务器返回信息:\"+result;\r\n");
      out.write("\t\t\t\t\t\t\t\t\tOFFICE_CONTROL_OBJ.activeDocument.saved=true;\r\n");
      out.write("\t\t\t\t\t\t\t\t</script>\r\n");
      out.write("\t\t\t\t\t\t\t\t<script language=\"JScript\" for=TANGER_OCX event=\"OnCustomMenuCmd2(menuPos,submenuPos,subsubmenuPos,menuCaption,menuID)\">\r\n");
      out.write("\t\t\t\t\t\t\t\talert(\"第\" + menuPos +\",\"+ submenuPos +\",\"+ subsubmenuPos +\"个菜单项,menuID=\"+menuID+\",菜单标题为\\\"\"+menuCaption+\"\\\"的命令被执行.\");\r\n");
      out.write("\t\t\t</script>\r\n");
      out.write("       </div>\r\n");
      out.write("</form>\r\n");
      out.write(" <script language=\"javascript\">\r\n");
      out.write("         var height=document.documentElement.clientHeight;\r\n");
      out.write("         var width=document.documentElement.clientWidth;\r\n");
      out.write("         $(\"#id_officeheight\").css('height',height-40);\r\n");
      out.write("         $(\"#id_officeheight\").css('width',width);\r\n");
      out.write("   </script>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
