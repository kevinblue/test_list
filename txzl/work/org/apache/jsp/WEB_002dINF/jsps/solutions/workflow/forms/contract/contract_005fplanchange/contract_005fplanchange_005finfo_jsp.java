/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.56
 * Generated at: 2017-03-09 04:12:08 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.WEB_002dINF.jsps.solutions.workflow.forms.contract.contract_005fplanchange;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;

public final class contract_005fplanchange_005finfo_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("\tvar plans =  mini.decode('");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${empty json_fund_rent_plan_str ? \"[]\" : json_fund_rent_plan_str}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("');\r\n");
      out.write("\tjQuery(function(){\r\n");
      out.write("\t\tvar datas = [];\r\n");
      out.write("\t\tfor(var i = 0 ; i< plans.length;i++){\r\n");
      out.write("\t\t\tvar plan = plans[i];\r\n");
      out.write("\t\t\tif(plan.planstatusname == '未回笼'){\r\n");
      out.write("\t\t\t\tdatas.push({text:\"第\"+plan.rentlist+\"期\",value:\"\"+plan.rentlist});\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tmini.get('startlist').setData(datas);\r\n");
      out.write("\t\tif(!mini.get('adjustlist')){\r\n");
      out.write("\t\t\tmini.get('adjustlist').setValue(plans.length);\r\n");
      out.write("\t\t}\r\n");
      out.write("\t});\r\n");
      out.write("</script>\r\n");
      out.write("<input name=\"nowRentList\" id=\"nowPlanDate\" type=\"hidden\" value=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['nowListPlanDate']}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\" /><!-- 选择期次对应的还款时间 -->\r\n");
      out.write("<input name=\"lastRentList\" id=\"lastPlanDate\" type=\"hidden\" value=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['lastListPlanDate']}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\" /><!-- 选择期次对应的上一期的还款时间 -->\r\n");
      out.write("<div  title=\"变更条件\"  id=\"changeInfoForm\"> \r\n");
      out.write("    <table class=\"fillTable\" cellspacing=\"0\" cellpadding=\"0\">\r\n");
      out.write("\t\t\t<tr class=\"tr-project-info tr-odd\">\r\n");
      out.write("\t\t        <td class=\"td-content-title\" width=\"12%\">变更开始期次:</td>\r\n");
      out.write("\t\t        <td class=\"td-content\" width=\"38%\"> <input  class=\"mini-combobox\" id=\"startlist\" label=\"变更开始期次\" name=\"fund_rent_adjust.startlist\" onvaluechanged=\"adjustListchange\" textField=\"text\" valueField=\"value\" vtype=\"int\" required=\"true\"  value=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['fund_rent_adjust.startlist'] }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\" /></td>\r\n");
      out.write("\t\t        <td class=\"td-content-title\" width=\"12%\">变更后总期次:</td>\r\n");
      out.write("\t\t        <td class=\"td-content\" width=\"38%\"><input name=\"fund_rent_adjust.adjustlist\" id=\"adjustlist\" vtype=\"int\" label=\"变更后总期次\" required=\"true\"  class=\"mini-textbox\"  required=\"true\" value=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['fund_rent_adjust.adjustlist'] }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\" /></td>\r\n");
      out.write("\t\t    </tr>\r\n");
      out.write("\t\t\t<tr class=\"tr-project-info tr-even\">\r\n");
      out.write("\t\t        <td class=\"td-content-title\" width=\"12%\">付款时间:</td>\r\n");
      out.write("\t\t        <td class=\"td-content\" width=\"38%\"> <input name=\"fund_rent_adjust.paydayadjust\" id=\"paydayadjust\" label=\"付款时间\" required=\"true\"  onvaluechanged=\"paydayAdustchange\" class=\"mini-datepicker\" value=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['fund_rent_adjust.paydayadjust'] }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\" required=\"true\" /> </td>\r\n");
      out.write("\t\t        <td class=\"td-content-title\"  width=\"12%\">变更年利率:</td>\r\n");
      out.write("\t\t        <td class=\"td-content\" width=\"38%\"><input  class=\"mini-textbox\" vtype=\"double\" required=\"true\" label=\"变更年利率\" name=\"fund_rent_adjust.yearrate\" id=\"yearrate\" value=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['fund_rent_adjust.yearrate'] }", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\" /> </td>\r\n");
      out.write("\t\t    </tr>\r\n");
      out.write("\t\t    <tr class=\"tr-project-info tr-even\" id=\"id_changebutton\">\r\n");
      out.write("                <td class=\"td-content\" colspan=\"4\" align=\"center\">\r\n");
      out.write("                \t<a class=\"mini-button\" iconCls=\"icon-user\" plain=\"true\" onclick=\"doRentChange\" style=\"color: red;\">租金变更</a>\r\n");
      out.write("                \t<a class=\"mini-button\" iconCls=\"icon-user\" plain=\"true\" onclick=\"cancelRentChange\" style=\"color: red;\">变更撤销</a>\r\n");
      out.write("                </td>\r\n");
      out.write("\t\t    </tr>\r\n");
      out.write("\t\t</table>\r\n");
      out.write("\t</div>\r\n");
      out.write("\t<script type=\"text/javascript\">\r\n");
      out.write("\t\tjQuery(function(){\r\n");
      out.write("\t\t\tif('");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.isView}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("' == 'true' || isViewHistoryTask==true){\r\n");
      out.write("\t\t\t\t  $(\"#id_changebutton\").hide();\r\n");
      out.write("\t\t\t\t  miniui_ext.disableFormFields(\"changeInfoForm\");\r\n");
      out.write("\t\t    };\r\n");
      out.write("\t\t});\t\r\n");
      out.write("\t\t/*\r\n");
      out.write("\t\t *起始期次改变触发函数\r\n");
      out.write("\t\t*/\r\n");
      out.write("\t\tfunction adjustListchange(e){\r\n");
      out.write("\t\t\tvar sender = e.sender;\r\n");
      out.write("\t\t\tvar startList = Number(sender.value);\r\n");
      out.write("\t\t\tfor(var i = 0 ; i< plans.length;i++){\r\n");
      out.write("\t\t\t\tvar plan = plans[i];\r\n");
      out.write("\t\t\t\tvar rentlist = plan.rentlist;\r\n");
      out.write("\t\t\t\tif(startList == Number(rentlist)){\r\n");
      out.write("\t\t\t\t\tjQuery('#nowPlanDate').val(plan.plandate);\r\n");
      out.write("\t\t\t\t\tmini.get('paydayadjust').setValue(plan.plandate);\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tif(startList == Number(rentlist)+1){\r\n");
      out.write("\t\t\t\t\tjQuery('#lastPlanDate').val(plan.plandate);\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tfunction paydayAdustchange(e){\r\n");
      out.write("\t\t\tvar adjustDateStr = mini.get('paydayadjust').getFormValue();\r\n");
      out.write("\t\t\tvar lastPlanDateStr = jQuery('#lastPlanDate').val();\r\n");
      out.write("\t\t\tvar adjustDate = new Date(adjustDateStr.replace(/-/g,'\\/'));\r\n");
      out.write("\t\t\tvar lastPlanDate = new Date((lastPlanDateStr+'').replace(/-/g,'\\/'));\r\n");
      out.write("\t\t\tif(adjustDate <= lastPlanDate){\r\n");
      out.write("\t\t\t\tmini.alert('付款日需大于变更其次上一期的还款日期！！！');\r\n");
      out.write("\t\t\t\tmini.get('paydayadjust').setValue(jQuery('#nowPlanDate').val());\r\n");
      out.write("\t\t\t}\t\t\t\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t\r\n");
      out.write("\t\tfunction doRentChange(){\r\n");
      out.write("\t\t\t//判断是否变更过\r\n");
      out.write("\t\t\tif(checkContractIsAdust()){\r\n");
      out.write("\t\t\t\tmini.alert('已经进行过租金变更，请撤销后在进行租金变更！');\r\n");
      out.write("\t\t\t\treturn;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\t//判断变更期次格式\r\n");
      out.write("\t\t\tvar numRegex  = /^[-\\+]?\\d+$/;\r\n");
      out.write("\t\t\tvar rateRegex = /^[-\\+]?\\d+(\\.[0-9]{1,6})?$/;\r\n");
      out.write("\t\t\tif(!numRegex.test(mini.get('adjustlist').getValue())){\r\n");
      out.write("\t\t\t\tmini.alert('请你输入正确的变更期次！！！');\r\n");
      out.write("\t\t\t\treturn ;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\tif(!rateRegex.test(mini.get('yearrate').getValue())){\r\n");
      out.write("\t\t\t\tmini.alert('请你输入正确的变更年利率！！！');\r\n");
      out.write("\t\t\t\treturn ;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\t//判断对应的合同编号以及流程号是否已租金变更\t\t\t\r\n");
      out.write("\t\t\tvar form = new mini.Form(\"changeInfoForm\");\r\n");
      out.write("\t\t\tvar formCondition = new mini.Form(\"businessconditionFormReadonly\");\r\n");
      out.write("\t\t\tvar o = form.getData(true,false);\r\n");
      out.write("\t\t\tvar o1 = formCondition.getData(true,false);\r\n");
      out.write("\t\t\tfor(var p in o){\r\n");
      out.write("\t\t\t\to1[p] = o[p];\r\n");
      out.write("\t\t\t}\t\r\n");
      out.write("\t\t\to1['fund_rent_adjust.adjustsavetype'] = 'reckon';\r\n");
      out.write("\t\t\to1['fund_rent_adjust.adjusttype'] = 'his_plan_change';\r\n");
      out.write("\t\t\to1['fund_rent_adjust.docid'] = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${currentProcessInstanceDBID}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\";\r\n");
      out.write("\t\t\to1['fund_rent_adjust.contract'] = mini.get('contract_id').getValue();\r\n");
      out.write("\t\t\to1['fund_rent_adjust.contractid'] = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['contract_info.id']}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\";\r\n");
      out.write("\t\t\to1['fund_rent_adjust.contractinfoid'] = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['contract_info.id']}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\";\r\n");
      out.write("\t\t\to1['fund_rent_adjust.jsonfundrentplanstr'] = '");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${empty json_fund_rent_plan_str ? \"[]\" : json_fund_rent_plan_str}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("';\r\n");
      out.write("\t\t\tmini.mask({\t\r\n");
      out.write("\t\t\t\tel: document.body,\r\n");
      out.write("\t\t\t\tcls: 'mini-mask-loading',\r\n");
      out.write("\t\t\t\thtml: '正在进行租金变更，请稍后...'\r\n");
      out.write("\t\t\t}); \r\n");
      out.write("\t\t    var url=\"");
      out.print(request.getContextPath() );
      out.write("/leasing/adjustCalculateOld.action\";\r\n");
      out.write("\t\t\t$.ajax({\r\n");
      out.write("\t\t        url: url,\r\n");
      out.write("\t\t        type: \"post\",\r\n");
      out.write("\t\t        data:  o1 ,\r\n");
      out.write("\t\t        success: function (text) {\r\n");
      out.write("\t\t        \tvar result = mini.decode(text);\r\n");
      out.write("\t\t        \tif(result.rentcalculaters == 'yes'){\r\n");
      out.write("\t\t\t        \tmini.alert(result.rentcalculatemsg);\r\n");
      out.write("\t\t\t        \tvar fundrentplan = result.rentplanlist;\r\n");
      out.write("\t\t\t        \t//租金计划按照期次进行排序\r\n");
      out.write("\t\t\t        \tfor(var k = 0 ; k < fundrentplan.length;k++){\r\n");
      out.write("\t\t\t        \t\tvar temprentlist ;\r\n");
      out.write("\t\t\t        \t\tvar date1 = Number(fundrentplan[k].rentlist);\r\n");
      out.write("\t\t\t        \t\tfor(var m = k + 1 ; m < fundrentplan.length ;m++){\r\n");
      out.write("\t\t\t        \t\t\tvar date2 = Number(fundrentplan[m].rentlist);\r\n");
      out.write("\t\t\t        \t\t\tif(date1 > date2){\r\n");
      out.write("\t\t\t        \t\t\t\tdate1 = date2;\r\n");
      out.write("\t\t\t        \t\t\t\ttemprentlist = fundrentplan[k] ;\r\n");
      out.write("\t\t\t        \t\t\t\tfundrentplan[k] = fundrentplan[m];\r\n");
      out.write("\t\t\t        \t\t\t\tfundrentplan[m] = temprentlist;\r\n");
      out.write("\t\t\t        \t\t\t\ttemprentlist = fundrentplan[k];\r\n");
      out.write("\t\t\t        \t\t\t}\r\n");
      out.write("\t\t\t        \t\t}\r\n");
      out.write("\t\t\t        \t\t\r\n");
      out.write("\t\t\t        \t}\r\n");
      out.write("\t\t\t        \tvar finacashdetail = result.cashdetaillist;\r\n");
      out.write("\t\t\t        \t//现金流根据计划日期进行排序\r\n");
      out.write("\t\t\t        \tfor(var i = 0 ; i < finacashdetail.length;i++){\r\n");
      out.write("\t\t\t        \t\tvar tempCashdetail ;\r\n");
      out.write("\t\t\t        \t\tvar plandate1 = new Date(finacashdetail[i].plandate.replace(/-/g,'/'));\r\n");
      out.write("\t\t\t        \t\tfor(var j = i + 1 ; j < finacashdetail.length ;j++){\r\n");
      out.write("\t\t\t        \t\t\tvar plandate2 = new Date(finacashdetail[j].plandate.replace(/-/g,'/'));\r\n");
      out.write("\t\t\t        \t\t\tif( plandate2 < plandate1){\r\n");
      out.write("\t\t\t        \t\t\t\ttempCashdetail = finacashdetail[i] ;\r\n");
      out.write("\t\t\t        \t\t\t\tfinacashdetail[i] = finacashdetail[j];\r\n");
      out.write("\t\t\t        \t\t\t\tfinacashdetail[j] = tempCashdetail;\r\n");
      out.write("\t\t\t        \t\t\t}\r\n");
      out.write("\t\t\t        \t\t}\r\n");
      out.write("\t\t\t        \t}\r\n");
      out.write("\t\t\t        \tvar fundchargeplan = result.fundchargeplan; \t\r\n");
      out.write("\t\t\t        \tmini.get(\"fund_rent_plan_new\").setData(fundrentplan);\r\n");
      out.write("\t\t\t        \tmini.get(\"fund_cash_flow_new\").setData(finacashdetail);\r\n");
      out.write("\t\t\t        \tmini.get(\"fund_fund_charge_new\").setData(fundchargeplan);\r\n");
      out.write("\t\t\t        \t\r\n");
      out.write("\t\t\t        \tjQuery(\"#id_json_fund_rent_plan_new_str\").val(mini.encode(fundrentplan));\r\n");
      out.write("\t\t\t        \tjQuery(\"#id_json_fund_cash_flow_new_str\").val(mini.encode(finacashdetail));\r\n");
      out.write("\t\t\t        \tjQuery(\"#id_json_fund_fund_charge_new_str\").val(mini.encode(fundchargeplan));\r\n");
      out.write("\r\n");
      out.write("\t\t\t        \t\r\n");
      out.write("\t\t\t        \tmini.get(\"framework_condition.irrshow\").setValue(result.irr);\r\n");
      out.write("\t\t\t        \tdocument.getElementById('framework_condition.irr').value = result.irr;\r\n");
      out.write("\t\t\t        \tmini.get(\"framework_condition.incomenumbershow\").setValue(mini.get('adjustlist').getValue());\r\n");
      out.write("\t\t\t        \tdocument.getElementById('framework_condition.incomenumber').value = mini.get('adjustlist').getValue();\r\n");
      out.write("\t\t\t        \tvar incomenumberyear =  mini.get('framework_condition.incomenumberyear').getValue().replace(\"income_\",'');\r\n");
      out.write("\t\t\t        \tmini.get(\"framework_condition.leasetermshow\").setValue(Number(mini.get('adjustlist').getValue())*Number(incomenumberyear));\r\n");
      out.write("\t\t\t        \tdocument.getElementById('framework_condition.leaseterm').value = Number(mini.get('adjustlist').getValue())*Number(incomenumberyear);\r\n");
      out.write("\t\t\t        \tmini.unmask(document.body);\r\n");
      out.write("\t\t        \t}else{\r\n");
      out.write("\t\t        \t\tmini.alert('服务器正忙，请与管理员联系！！！！');\r\n");
      out.write("\t\t        \t\tmini.unmask(document.body);\r\n");
      out.write("\t\t        \t}\r\n");
      out.write("\t\t        \t\r\n");
      out.write("\t\t        },\r\n");
      out.write("\t\t        error: function (jqXHR, textStatus, errorThrown) {\r\n");
      out.write("\t\t        \tmini.unmask(document.body);\r\n");
      out.write("\t\t            alert(jqXHR.responseText);\r\n");
      out.write("\t\t        }\r\n");
      out.write("\t\t    });\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tfunction cancelRentChange(){\r\n");
      out.write("\t\t\t\r\n");
      out.write("\t\t\t//判断是否变更过\r\n");
      out.write("\t\t\tif(!checkContractIsAdust()){\r\n");
      out.write("\t\t\t\tmini.alert('未进行租金变更操作，无法进行撤销！！');\r\n");
      out.write("\t\t\t\treturn;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\tvar param ={};\r\n");
      out.write("\t\t\tparam['fund_rent_adjust.docid'] = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${currentProcessInstanceDBID}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\";\r\n");
      out.write("\t\t\tparam['fund_rent_adjust.contractid'] = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['contract_info.id']}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\";\r\n");
      out.write("\t\t\tmini.mask({\t\r\n");
      out.write("\t\t\t\tel: document.body,\r\n");
      out.write("\t\t\t\tcls: 'mini-mask-loading',\r\n");
      out.write("\t\t\t\thtml: '正在进行变更撤销，请稍后...'\r\n");
      out.write("\t\t\t}); \r\n");
      out.write("\t\t    var url=\"");
      out.print(request.getContextPath() );
      out.write("/leasing/resetAdjust.action\";\r\n");
      out.write("\t\t\t$.ajax({\r\n");
      out.write("\t\t        url: url,\r\n");
      out.write("\t\t        type: \"post\",\r\n");
      out.write("\t\t        data:  param,\r\n");
      out.write("\t\t        success: function (text) {\r\n");
      out.write("\t\t        \tvar  fundrentplan = mini.get('fund_rent_plan').getData();\r\n");
      out.write("\t\t        \tvar finacashdetail = mini.get('fund_cash_flow').getData();\r\n");
      out.write("\t\t        \tvar fundfundplan = mini.get('fund_fund_charge').getData();\r\n");
      out.write("\t\t        \t\r\n");
      out.write("\t\t        \tmini.get(\"fund_rent_plan_new\").setData(fundrentplan);\r\n");
      out.write("\t\t        \tmini.get(\"fund_cash_flow_new\").setData(finacashdetail);\r\n");
      out.write("\t\t        \tmini.get(\"fund_fund_charge_new\").setData(fundfundplan);\r\n");
      out.write("\t\t        \t\r\n");
      out.write("\t\t        \tjQuery(\"#id_json_fund_rent_plan_new_str\").val(mini.encode(fundrentplan));\r\n");
      out.write("\t\t        \tjQuery(\"#id_json_fund_cash_flow_new_str\").val(mini.encode(finacashdetail));\r\n");
      out.write("\t\t        \tjQuery(\"#id_json_fund_fund_charge_new_str\").val(mini.encode(fundfundplan));\r\n");
      out.write("\t\t        \tvar irr = $('#irr').val();\r\n");
      out.write("\t\t        \tmini.get(\"framework_condition.irrshow\").setValue(irr);\r\n");
      out.write("\t\t        \tdocument.getElementById('framework_condition.irr').value = irr;\r\n");
      out.write("\t\t        \tmini.get(\"framework_condition.incomenumbershow\").setValue(mini.get('incomenumber').getValue());\r\n");
      out.write("\t\t        \tdocument.getElementById('framework_condition.incomenumber').value = mini.get('incomenumber').getValue();\r\n");
      out.write("\t\t        \tmini.get(\"framework_condition.leasetermshow\").setValue(mini.get('leaseterm').getValue());\r\n");
      out.write("\t\t        \tdocument.getElementById('framework_condition.leaseterm').value = mini.get('leaseterm').getValue();\r\n");
      out.write("\t\t        \tmini.unmask(document.body);\r\n");
      out.write("\t\t        \tmini.alert('撤销成功！');\r\n");
      out.write("\t\t        },\r\n");
      out.write("\t\t        error: function (jqXHR, textStatus, errorThrown) {\r\n");
      out.write("\t\t        \tmini.unmask(document.body);\r\n");
      out.write("\t\t            alert(jqXHR.responseText);\r\n");
      out.write("\t\t        }\r\n");
      out.write("\t\t    });\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tfunction checkContractIsAdust(contractId,docId){\r\n");
      out.write("\t\t\tvar isAdjust = true;\r\n");
      out.write("\t\t\tvar param = {};\r\n");
      out.write("\t\t\tvar contractId = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['contract_info.id']}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\";\r\n");
      out.write("\t\t\tvar docid  = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${currentProcessInstanceDBID}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\";\r\n");
      out.write("\t\t\tparam.contractId=  contractId;\r\n");
      out.write("\t\t\tparam.docid = docid;\r\n");
      out.write("\t\t\tparam['xmlFileName'] = \"/eleasing/workflow/contract/contract_planchange/contract_rent_adjust_check.xml\";\r\n");
      out.write("\t\t\tajaxRequest({\r\n");
      out.write("\t\t\t\tparams:param,\r\n");
      out.write("\t\t\t\turl:'");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/table/getTableData.action',\r\n");
      out.write("\t\t\t\ttimeout:30*60*1000,\r\n");
      out.write("\t\t\t\tasync : false,\r\n");
      out.write("\t\t\t\tsuccess:function(response){\r\n");
      out.write("\t\t\t\t\tvar jsondata = eval('(' + response.responseText + ')').datas;\r\n");
      out.write("\t\t\t\t\tif(Number(jsondata[0].num) > 0 ){\r\n");
      out.write("\t\t\t\t\t\tisAdjust = true;\r\n");
      out.write("\t\t\t\t\t}else{\r\n");
      out.write("\t\t\t\t\t\tisAdjust = false;\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t},\r\n");
      out.write("\t\t\t\tfailure:function(response){\r\n");
      out.write("\t\t\t\t\tisAdjust =  false;\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t\t\treturn isAdjust;\r\n");
      out.write("\t\t}\r\n");
      out.write("\t</script>\r\n");
      out.write("\t\r\n");
      out.write(" \r\n");
      out.write("    \r\n");
      out.write("\r\n");
      out.write("\r\n");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
