/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.56
 * Generated at: 2017-06-16 05:51:38 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.WEB_002dINF.jsps.solutions.workflow.forms.contract.contract_005fcomm;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;

public final class contract_005fword_005fancillary_005fnumset_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/tenwa/init.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\" src=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/tenwa/tenwa.js\"></script>\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("\r\n");
      out.write("seajs.use([\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/tenwa/init.js\"]);\r\n");
      out.write("var projid = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['contract_info.projid']}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\";\r\n");
      out.write("var conid = \"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['contract_info.id']}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\";\r\n");
      out.write("jQuery(function(){\r\n");
      out.write("\t\t    seajs.use([ \"js/apcomponent/aptable/aptable.js\" ], function(ApTable) {\r\n");
      out.write("\t\t\tnew ApTable({\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tshowToolbar: showTools,\r\n");
      out.write("\t\t\t\tid: \"id_tasks_table1\",\r\n");
      out.write("\t\t\t\trenderTo: \"id_tasksContainer2\",\r\n");
      out.write("\t\t\t\twidth: '100%',\r\n");
      out.write("\t\t\t\theight: '100%',\r\n");
      out.write("\t\t\t\theight: 260,\r\n");
      out.write("\t\t\t\tshowPager : false,\r\n");
      out.write("\t\t\t\tlazyLoad : false,\r\n");
      out.write("\t\t\t\ttitle:'合同编号设置',\r\n");
      out.write("\t\t\t\tremoteOper : true,\r\n");
      out.write("\t\t\t\tentityClassName : \"com.tenwa.leasing.entity.proj.ContractNumberSetting\",\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tparams:{\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\tconid:conid\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t},\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tmultiSelect: false,\r\n");
      out.write("\t\t\t\txmlFileName : '/eleasing/workflow/contract/contract_ancillary/contract_ancillary_number_setting.xml',\r\n");
      out.write("\t\t\t\tqueryButtonColSpan : 6,\r\n");
      out.write("\t\t\t\tqueryButtonNewLine : true,\r\n");
      out.write("\t\t\t\tcolumns: [\r\n");
      out.write("                 { type : 'checkcolumn'},\r\n");
      out.write("\t\t\t\t\t{ header:'序号',type : 'indexcolumn'},\r\n");
      out.write("\t\t\t\t\t{field:'id',\r\n");
      out.write("\t\t\t\t\t\theader:'主键',\r\n");
      out.write("\t\t\t\t\t\tvisible: false,\r\n");
      out.write("\t\t\t\t\t\tformEditorConfig:{\r\n");
      out.write("\t\t\t\t\t\t\tfieldVisible: false,\r\n");
      out.write("\t\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t{field:'contractname',\r\n");
      out.write("\t\t\t\t\t\theader:'合同名称',\r\n");
      out.write("\t\t\t\t\t\tvisible: true,\r\n");
      out.write("\t\t\t\t\t\tformEditorConfig:{\r\n");
      out.write("\t\t\t\t\t\t\t required:true,\r\n");
      out.write("\t\t\t\t\t\t\tfieldVisible: true,\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t{field:'contractnumber',\r\n");
      out.write("\t\t\t\t\t\theader:'合同编号',\r\n");
      out.write("\t\t\t\t\t\tvisible: true,\r\n");
      out.write("\t\t\t\t\t\tformEditorConfig:{\r\n");
      out.write("\t\t\t\t\t\t\t required:true,\r\n");
      out.write("\t\t\t\t\t\t\tfieldVisible: true,\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t{field:'oldcontnum',\r\n");
      out.write("\t\t\t\t\t\theader:'修改前合同编号',\r\n");
      out.write("\t\t\t\t\t\tvisible: false,\r\n");
      out.write("\t\t\t\t\t\tformEditorConfig:{\r\n");
      out.write("\t\t\t\t\t\t\tfieldVisible: false,\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t{field:'docid',\r\n");
      out.write("\t\t\t\t\t\theader:'流程ID',\r\n");
      out.write("\t\t\t\t\t\tvisible: false,\r\n");
      out.write("\t\t\t\t\t\tformEditorConfig:{\r\n");
      out.write("\t\t\t\t\t\t\tvalue:flowUnid,\r\n");
      out.write("\t\t\t\t\t\t\tfieldVisible: false,\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t{field:'contractsubject',\r\n");
      out.write("\t\t\t\t\t\theader:'合同主体',\r\n");
      out.write("\t\t\t\t\t\tvisible: true,\r\n");
      out.write("\t\t\t\t\t\tformEditorConfig:{\r\n");
      out.write("\t\t\t\t\t\t\tfieldVisible: true,\r\n");
      out.write("\t\t\t\t\t\t\tvalueField:'value'\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t{\r\n");
      out.write("\t\t\t\t\t\tfield:'contracttypename',\r\n");
      out.write("\t\t\t\t\t\tvisible:true,\r\n");
      out.write("\t\t\t\t\t\theader:'合同类型',\r\n");
      out.write("\t\t   \t\t         formEditorConfig:{\r\n");
      out.write("\t\t\t\t\t         fieldVisible:false,\r\n");
      out.write("\t\t\t\t\t             }\r\n");
      out.write("\t\t\t\t\t},\r\n");
      out.write("\t\t\t\t\t{\r\n");
      out.write("\t\t\t\t\t\tfield:'contracttype',\r\n");
      out.write("\t\t\t\t\t\tvisible:false,\r\n");
      out.write("\t\t\t\t\t\theader:'合同类型',\r\n");
      out.write("\t\t   \t\t         formEditorConfig:{\r\n");
      out.write("\t\t   \t\t\t              newLine:true,\r\n");
      out.write("\t\t\t\t\t             required:true,\r\n");
      out.write("\t\t\t\t\t          multiSelect:false, \r\n");
      out.write("\t\t\t\t\t            textField:'name',\r\n");
      out.write("\t\t\t\t\t           valueField:'value',\r\n");
      out.write("\t\t\t\t\t           showNullItem:\"true\",\r\n");
      out.write("\t\t\t\t\t           nullItemText:\"\",\r\n");
      out.write("\t\t\t\t\t         fieldVisible:true,}},\r\n");
      out.write("\t\t\t\t\t{field:'custid',\r\n");
      out.write("\t\t\t\t\t\theader:'客户信息',\r\n");
      out.write("\t\t\t\t\t\tvisible: false,\r\n");
      out.write("\t\t\t\t\t\tformEditorConfig:{\r\n");
      out.write("\t\t\t\t\t\t\tfieldVisible: true,\r\n");
      out.write("\t\t\t\t\t\t\t textField:'name',\r\n");
      out.write("\t\t\t\t\t          valueField:'value',\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t}, {\r\n");
      out.write("\t\t\t\t\t\tfield : 'mark',\r\n");
      out.write("\t\t\t\t\t\theader : '备注',\r\n");
      out.write("\t\t\t\t\t\theaderAlign : 'center',\r\n");
      out.write("\t\t\t\t\t\tformEditorConfig : {\r\n");
      out.write("\t\t\t\t\t\t\tnewLine : true,\r\n");
      out.write("\t\t\t\t\t\t\twidth : 495,\r\n");
      out.write("\t\t\t\t\t\t\tcolspan : 6,\r\n");
      out.write("\t\t\t\t\t\t\theight : 55,\r\n");
      out.write("\t\t\t\t\t\t\ttype : 'textarea'\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t] \r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t\t});\r\n");
      out.write("\t});\r\n");
      out.write("\r\n");
      out.write("seajs.use([\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/js/tenwa/init.js\"]);\r\n");
      out.write("var leaseForm = [{value: '1',name: '直租'}, {value: '2',name: '回租'}, {value: '0',name: '其它'}];\r\n");
      out.write("var comboParams = {\r\n");
      out.write("\toneclassifyCode:\"wordtempletypefirst7\",\r\n");
      out.write("\txmlFileName:\"/eleasing/jsp/template_word/templatewordSelect.xml\"\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("jQuery(function(){\r\n");
      out.write("\ttenwa.lazyLoadCombo(\"twoclassify\",{oneclassifyCode:\"wordtempletypefirst7\",twoclassify:true,xmlFileName:\"/eleasing/jsp/template_word/templatewordSelect.xml\"});\r\n");
      out.write("});\r\n");
      out.write("//加载下一层级分类\r\n");
      out.write("function reloadNextClassify(e,comboid,nextcomboid){\r\n");
      out.write("\tcomboboxChanged(e)\r\n");
      out.write("\tif(nextcomboid.length>2){\r\n");
      out.write("\t\tvar combo = mini.get(comboid);\r\n");
      out.write("\t\tvar nextCombo = mini.get(nextcomboid);\r\n");
      out.write("\t\tvar nextComboParams = mini.clone(comboParams);\r\n");
      out.write("\t\tvar comboUrl = window.globalWebRoot + '/table/getTableData.action';\r\n");
      out.write("\t\tif(comboid == \"twoclassify\"){\r\n");
      out.write("\t\t\tnextComboParams.threeclassify = true;\r\n");
      out.write("\t\t\tnextComboParams.twoclassifycode = combo.getValue();\r\n");
      out.write("/*  \t\t\tmini.get(\"threeclassify\").setValue();\r\n");
      out.write("\t\t\tmini.get(\"fourclassify\").setValue();\r\n");
      out.write("\t\t\tmini.get(\"fiveclassify\").setValue(); \r\n");
      out.write("\t\t\tmini.get(\"sixclassify\").setValue();  */\r\n");
      out.write("\t\t}else if(comboid == \"threeclassify\"){\r\n");
      out.write("\t\t\tnextComboParams.fourclassify = true;\r\n");
      out.write("\t\t\tnextComboParams.twoclassifycode = mini.get(\"twoclassify\").getValue();\r\n");
      out.write("\t\t\tnextComboParams.threeclassifycode = combo.getValue();\r\n");
      out.write("\t   /*   \tmini.get(\"fourclassify\").setValue();\r\n");
      out.write("\t\t\tmini.get(\"fiveclassify\").setValue(); \r\n");
      out.write("\t\t\tmini.get(\"sixclassify\").setValue(); */\r\n");
      out.write("\t\t}else if(comboid == \"fourclassify\"){\r\n");
      out.write("\t\t\tnextComboParams.fiveclassify = true;\r\n");
      out.write("\t\t\tnextComboParams.twoclassifycode = mini.get(\"twoclassify\").getValue();\r\n");
      out.write("\t\t\tnextComboParams.threeclassifycode = mini.get(\"threeclassify\").getValue();\r\n");
      out.write("\t\t\tnextComboParams.fourclassifycode = combo.getValue();\r\n");
      out.write("/* \t\t \tmini.get(\"fiveclassify\").setValue(); \r\n");
      out.write("\t\t\tmini.get(\"sixclassify\").setValue(); */\r\n");
      out.write("\t\t}else{\r\n");
      out.write("\t\t\tnextComboParams.sixclassify = true;\r\n");
      out.write("\t\t\tnextComboParams.twoclassifycode = mini.get(\"twoclassify\").getValue();\r\n");
      out.write("\t/* \t\tnextComboParams.threeclassifycode = mini.get(\"threeclassify\").getValue();\r\n");
      out.write("\t\t\tnextComboParams.fourclassifycode = mini.get(\"fourclassify\").getValue();  */\r\n");
      out.write("\t\t\tnextComboParams.fiveclassifycode = combo.getValue();\r\n");
      out.write("\t\t/* \tmini.get(\"sixclassify\").setValue(); */\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tvar nextComboParamsUrl = aputil.getParamsUrl(comboUrl, nextComboParams);\r\n");
      out.write("\t\t//mini.get(nextcomboid).setUrl(nextComboParamsUrl);\r\n");
      out.write("\t}\r\n");
      out.write("\tchargeTemplate();\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("//获取合同模板\r\n");
      out.write("function chargeTemplate() {\r\n");
      out.write("\tvar twoClassify = mini.get(\"twoclassify\").getValue();\r\n");
      out.write("/* \tvar threeClassify = mini.get(\"threeclassify\").getValue();\r\n");
      out.write("\tvar fourClassify = mini.get(\"fourclassify\").getValue();\r\n");
      out.write("\tvar fiveClassify = mini.get(\"fiveclassify\").getValue(); \r\n");
      out.write("\tvar sixClassify = mini.get(\"sixclassify\").getValue(); */\r\n");
      out.write("\tif (twoClassify != \"\") {\r\n");
      out.write("\t\tvar param = {};\r\n");
      out.write("\t\tparam[\"twoClassify\"] = twoClassify;\r\n");
      out.write("/* \t\tparam[\"threeClassify\"] = threeClassify;\r\n");
      out.write(" \t\tparam[\"fourClassify\"] = fourClassify;\r\n");
      out.write("\t\tparam[\"fiveClassify\"] = fiveClassify; \r\n");
      out.write("\t\tparam[\"sixClassify\"] = sixClassify; */\r\n");
      out.write("\t\t//window.currentDeleteFileLoadMask = new tracywindyLoadMask(document.body, \"正在加载合同模板 请稍等...\");\r\n");
      out.write("\t\t//currentDeleteFileLoadMask.show();\r\n");
      out.write("\t    param[\"changeRowNum\"]=4;\r\n");
      out.write("\t\tajaxRequest({\r\n");
      out.write("\t\t\turl : '");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${pageContext.request.contextPath}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("/leasing/template/loadTemplateByClassify.action',\r\n");
      out.write("\t\t\tmethod : 'POST',\r\n");
      out.write("\t\t\tsuccess : ajaxChargeTemplateCallBack,\r\n");
      out.write("\t\t\tasync : false,\r\n");
      out.write("\t\t\tfailure : function(res) {\r\n");
      out.write("\t\t\t\t//currentDeleteFileLoadMask.hide();\r\n");
      out.write("\t\t\t\tmini.alert(\"抓合同模板失败!\");\r\n");
      out.write("\t\t\t},\r\n");
      out.write("\t\t\tparams : param\r\n");
      out.write("\t\t});\r\n");
      out.write("\t} else {\r\n");
      out.write("\t\tdocument.getElementById(\"contract_word_check_list\").innerHTML = \"请选择筛选项!\";\r\n");
      out.write("\t}\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function ajaxChargeTemplateCallBack(rs){\r\n");
      out.write("\tvar svote=rs.responseText;\r\n");
      out.write("    svote=svote.replace(/(^\\s+)|(\\s+$)/g, \"\"); \r\n");
      out.write("    document.getElementById(\"contract_word_check_list\").innerHTML=svote;\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("function getTempateIdInfo() {\r\n");
      out.write("\tvar tempid = \"\";\r\n");
      out.write("\t$('input[name=\"contract_word_list_check_box\"]:checked').each(\r\n");
      out.write("\t\t\tfunction() {\r\n");
      out.write("\t\t\t\t//chk_value.push($(this).val());\r\n");
      out.write("\t\t\t\tif (tempid.length > 0) {\r\n");
      out.write("\t\t\t\t\ttempid = tempid + \",\";\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\ttempid = tempid + $(this).val();\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\t$('input[name=\"contract_word_list_check_box\"]:checked').each(\r\n");
      out.write("\t\t\tfunction() {\r\n");
      out.write("\t\t\t\t//chk_value.push($(this).attr(\"checked\", false));\r\n");
      out.write("\t\t\t});\r\n");
      out.write("\treturn tempid;\r\n");
      out.write("}\r\n");
      out.write("function createContractWord() {\r\n");
      out.write("\tvar tempids = getTempateIdInfo();\r\n");
      out.write("\tif (\"\" == tempids){\r\n");
      out.write("\t\tmini.alert(\"请选择合同模板\");return;\r\n");
      out.write("\t}\r\n");
      out.write("\tvar params = {};\r\n");
      out.write("\tparams[\"flowunid\"] = flowUnid;\r\n");
      out.write("\tparams[\"templateid\"] = tempids;\r\n");
      out.write("\tparams[\"custcreatetemplateno\"]=\"\";\r\n");
      out.write("\tparams[\"custcreatetemplatemethod\"]=\"\";\r\n");
      out.write("\tinitCreateWordData(params);\r\n");
      out.write("\tvar fileTeplate = new fileTemplateConfig({\r\n");
      out.write("\t\tisAttachment : true,\r\n");
      out.write("\t\tattachmentParams: {\r\n");
      out.write("\t\t\tmodule:'WorkflowAttchmentFiles',\r\n");
      out.write("\t\t\tjbpmWorkflowHistoryInfoId : window.currentJbpmWorkflowHistoryInfoId ? window.currentJbpmWorkflowHistoryInfoId : '',\r\n");
      out.write("\t\t\tattachmentFileDictId : 'root.FileType.ContractFile.01',//合同文件ID\r\n");
      out.write("\t\t\tidentifierOne:window.assignAttachmentKeyOne||\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${currentProcessInstanceDBID}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\",\r\n");
      out.write("\t\t\tidentifierTwo:window.assignAttachmentKeyTwo||jQuery(\"#id_currentHistoryTaskInfo_keyOne\").val(),\r\n");
      out.write("\t\t\tidentifierThree:window.assignAttachmentKeyThree||jQuery(\"#id_currentHistoryTaskInfo_keyTwo\").val(),\r\n");
      out.write("\t\t\tidentifierFour:window.assignAttachmentKeyFour||jQuery(\"#id_currentHistoryTaskInfo_keyThree\").val(),\r\n");
      out.write("\t\t\tidentifierFive:window.assignAttachmentKeyFive||jQuery(\"#id_currentHistoryTaskInfo_keyFour\").val(),\r\n");
      out.write("\t\t\tidentifierSix:window.assignAttachmentKeySix||jQuery(\"#id_currentHistoryTaskInfo_keyFive\").val(),\r\n");
      out.write("\t\t\tidentifierSeven:window.assignAttachmentKeySeven||jQuery(\"#id_currentHistoryTaskInfo_keySix\").val(),\r\n");
      out.write("\t\t\tidentifierEight:window.assignAttachmentKeyEight||jQuery(\"#id_currentHistoryTaskInfo_keySeven\").val(),\r\n");
      out.write("\t\t\tidentifierNine:window.assignAttachmentKeyNine||jQuery(\"#id_currentHistoryTaskInfo_keyEight\").val(),\r\n");
      out.write("\t\t\tidentifierTen:window.assignAttachmentKeyTen||jQuery(\"#id_currentHistoryTaskInfo_keyNine\").val()\r\n");
      out.write("\t\t},\r\n");
      out.write("\t\ttableid : \"contract_word\",\r\n");
      out.write("\t\tmodelname : \"合同管理\",\r\n");
      out.write("\t\turl : '/leasing/template/CreateFileByTemplate.action',\r\n");
      out.write("\t\tparames : params\r\n");
      out.write("\t});\r\n");
      out.write("\tfileTeplate.createFile();\r\n");
      out.write("\tif (mini.get(\"id_customworkflowattachment\")) {\r\n");
      out.write("\t\tmini.get(\"id_customworkflowattachment\").reload();\r\n");
      out.write("\t\tmini.get(\"id_workflowhisAttachment\").reload();\r\n");
      out.write("\t}\r\n");
      out.write("}\r\n");
      out.write("function initCreateWordData(params) {\r\n");
      out.write("\tvar regx=new RegExp(',','g');\r\n");
      out.write("\tvar temp_obj={};\r\n");
      out.write("\tvar temp_arr=[];\r\n");
      out.write("\t//追加参数\r\n");
      out.write("\tvar signatory_form=new mini.Form(\"contract_signatory_form\");\r\n");
      out.write("\tvar signatory_data=signatory_form.getData().contract_signatory;\r\n");
      out.write("\tfor(var sfd in signatory_data){\r\n");
      out.write("\t\tparams[\"contract_signatory.\"+sfd]=signatory_data[sfd];\r\n");
      out.write("\t}\r\n");
      out.write("\t//租金开票信息\r\n");
      out.write("\tvar contract_rent_invoice_type_form=new mini.Form(\"contract_rent_invoice_type_form\");\r\n");
      out.write("\tvar contract_rent_invoice_type_data=contract_rent_invoice_type_form.getData().contract_invoice_type;\r\n");
      out.write("\tfor(var critf in contract_rent_invoice_type_data){\r\n");
      out.write("\t\tparams[\"contract_invoice_type.\"+critf]=contract_rent_invoice_type_data[critf];\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\t//合同基本信息\r\n");
      out.write("\t var contract_base_info_form=new mini.Form(\"contract_base_info_form\");\r\n");
      out.write("\t var contract_base_info_data=contract_base_info_form.getData().contract_info;\r\n");
      out.write("\tfor(var cbid in contract_base_info_data){\r\n");
      out.write("\t\tparams[\"contract_info.\"+cbid]=contract_base_info_data[cbid];\r\n");
      out.write("\t}\r\n");
      out.write("\tparams['contract_info.leasformname']=mini.getbyName(\"contract_info.leasform\").getValue();\r\n");
      out.write("\tif(mini.getbyName(\"contract_info.leasform\").getValue() == \"售后回租\"){\r\n");
      out.write("\t\tparams['leas.leasback'] = \"融资租赁合同(售后回租)\";\r\n");
      out.write("\t}else{\r\n");
      out.write("\t\tparams['leas.leasback'] = \"融资租赁合同\";\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tparams['con.info']=(params[\"contract_info.contractnumber\"]).replace(/P/,'PL')+params[\"contract_info.custname\"];\r\n");
      out.write("\t//购买类合同编号\r\n");
      out.write("\tparams['buytype_contract.number']=(params[\"contract_info.contractnumber\"]).replace(/P/,'PS');\r\n");
      out.write("\t//咨询服务协议\r\n");
      out.write("\tparams['askservice_contract.number']=(params[\"contract_info.contractnumber\"]).replace(/P/,'PC');\r\n");
      out.write("\t//其他类合同编号\r\n");
      out.write("\tparams['othertype_contract.number']=(params[\"contract_info.contractnumber\"]).replace(/P/,'PL');\r\n");
      out.write("\t//租赁物明显\r\n");
      out.write("\tvar contract_equip=mini.get(\"contract_equip\").getData();\r\n");
      out.write("\tparams[\"contract_equip_list\"]=mini.encode(contract_equip);\r\n");
      out.write("\t\r\n");
      out.write("\tvar jsondata=mini.get(\"contract_equip\").getData();\r\n");
      out.write("\tvar totalPrice = 0;\r\n");
      out.write("\tfor ( var i = 0; i < jsondata.length; i++) {\r\n");
      out.write("\t\ttotalPrice += parseFloat(jsondata[i]['equipprice']);\r\n");
      out.write("\t}\r\n");
      out.write("\tparams[\"contract_equip.totalprice\"]=totalPrice;\r\n");
      out.write("\tparams[\"contract_equip.dxtotalprice\"]=DX(totalPrice);\r\n");
      out.write("\t \r\n");
      out.write("\tvar rent_plan_grid=mini.get(\"fund_rent_plan_frame\").getData();\r\n");
      out.write("\t\r\n");
      out.write("\t\r\n");
      out.write("\tvar totalrent=0;\r\n");
      out.write("\tvar rent_plan_cn=[];\r\n");
      out.write("\tfor(var i=0;i<rent_plan_grid.length;i++){\r\n");
      out.write("\t\tvar temp_rent_plan={};\r\n");
      out.write("\t\ttemp_rent_plan[\"rentlist\"]=\"第\"+rent_plan_grid[i].rentlist+\"期\";\r\n");
      out.write("\t\ttemp_rent_plan[\"rent\"]=\"人民币\"+rent_plan_grid[i].rent+\"元\";\r\n");
      out.write("\t\ttotalrent+=parseFloat(rent_plan_grid[i].rent.replace(regx,''));\r\n");
      out.write("\t\trent_plan_cn.push(temp_rent_plan);\r\n");
      out.write("\t}\r\n");
      out.write("\tparams[\"rent_plan\"]=mini.encode(rent_plan_cn);\r\n");
      out.write("\t\r\n");
      out.write("\t//商务条件\r\n");
      out.write("\tparams[\"contract_condition.equipamt\"]=mini.get(\"equipamt\").getValue().replace(regx,'');\r\n");
      out.write("\tparams[\"contract_condition.dxequipamt\"]=DX(mini.get(\"equipamt\").getValue().replace(regx,''));\r\n");
      out.write("\tparams[\"contract_condition.cautionmoney\"]=mini.get(\"cautionmoney\").getValue().replace(regx,'');\r\n");
      out.write("\tparams[\"contract_condition.dxcautionmoney\"]=DX(params[\"contract_condition.cautionmoney\"]);\r\n");
      out.write("\tparams[\"contract_condition.cleanleasemoney\"]=mini.get(\"cleanleasemoney\").getValue().replace(regx,'');\r\n");
      out.write("\tparams[\"contract_condition.handlingchargemoney\"]=mini.get(\"handlingchargemoney\").getValue().replace(regx,'');\r\n");
      out.write("\tparams[\"contract_condition.dxhandlingchargemoney\"]=DX(params[\"contract_condition.handlingchargemoney\"]);\r\n");
      out.write("\tparams[\"contract_condition.firstpayment\"]=mini.get(\"firstpayment\").getValue().replace(regx,'');\r\n");
      out.write("\tparams[\"contract_condition.insuremoney\"]=mini.get(\"insuremoney\").getValue().replace(regx,'');\r\n");
      out.write("\tparams[\"contract_condition.incomenumber\"]=mini.get(\"incomenumber\").getValue();\r\n");
      out.write("\tparams[\"contract_condition.leaseterm\"]=mini.get(\"leaseterm\").getValue();//租赁期限（月）\r\n");
      out.write("\tparams[\"contract_condition.leasetermyear\"]=decimal(parseFloat(mini.get(\"leaseterm\").getValue())/12,0);//租赁期限（月）\r\n");
      out.write("\tparams[\"contract_condition.totalrent\"]=decimal(totalrent,2);\r\n");
      out.write("\tparams[\"contract_condition.dxtotalrent\"]=DX(decimal(totalrent,2));\r\n");
      out.write("\tparams[\"contract_condition.periodtype\"]=mini.get(\"periodtype\").getText();//租金支付类型\r\n");
      out.write("\tif(mini.get(\"incomenumberyear\").getValue()=='income_1'){\r\n");
      out.write("\t\tparams[\"contract_condition.incomenumberyear\"]='1';\r\n");
      out.write("\t\tparams[\"contract_condition.dxincomenumberyear\"]='每壹个月支付一期';\r\n");
      out.write("\t}else if(mini.get(\"incomenumberyear\").getValue()=='income_3'){\r\n");
      out.write("\t\tparams[\"contract_condition.incomenumberyear\"]='3';\r\n");
      out.write("\t\tparams[\"contract_condition.dxincomenumberyear\"]='每叁个月支付一期';\r\n");
      out.write("\t}else if(mini.get(\"incomenumberyear\").getValue()=='income_6'){\r\n");
      out.write("\t\tparams[\"contract_condition.incomenumberyear\"]='6';\r\n");
      out.write("\t\tparams[\"contract_condition.dxincomenumberyear\"]='每陆个月支付一期';\r\n");
      out.write("\t}else if(mini.get(\"incomenumberyear\").getValue()=='income_12'){\r\n");
      out.write("\t\tparams[\"contract_condition.incomenumberyear\"]='壹拾贰';\r\n");
      out.write("\t\tparams[\"contract_condition.dxincomenumberyear\"]='每壹拾贰个月支付一期';\r\n");
      out.write("\t}else if(mini.get(\"incomenumberyear\").getValue()=='income_2'){\r\n");
      out.write("\t\tparams[\"contract_condition.incomenumberyear\"]='贰';\r\n");
      out.write("\t\tparams[\"contract_condition.dxincomenumberyear\"]='每贰个月支付一期';\r\n");
      out.write("\t}else if(mini.get(\"incomenumberyear\").getValue()=='income_0'){\r\n");
      out.write("\t\tparams[\"contract_condition.dxincomenumberyear\"]='不规则期间还款，具体支付日见《起租通知书》';\r\n");
      out.write("\t}\r\n");
      out.write("\tvar totalincome=0;\r\n");
      out.write("\tvar managementmoney=mini.get(\"managementmoney\").getValue().replace(regx,'');\r\n");
      out.write("\tvar nominalprice=mini.get(\"nominalprice\").getValue().replace(regx,'');\r\n");
      out.write("\tvar beforeinterest=mini.get(\"beforeinterest\").getValue().replace(regx,'');\r\n");
      out.write("\tvar otherincome=mini.get(\"otherincome\").getValue().replace(regx,'');\r\n");
      out.write("\ttotalincome=decimal(parseFloat(totalrent)+parseFloat(params[\"contract_condition.handlingchargemoney\"])+parseFloat(managementmoney)\r\n");
      out.write("\t\t\t              +parseFloat(params[\"contract_condition.firstpayment\"])+parseFloat(nominalprice)+parseFloat(otherincome)+parseFloat(beforeinterest),2);\r\n");
      out.write("\tparams[\"contract_condition.totalincome\"]=totalincome;\r\n");
      out.write("\tif(mini.get(\"adjuststyle\").getValue()=='固定利率'){\r\n");
      out.write("\t\tparams[\"contract_rule.ratefloattype\"]='本合同实际起租后，在本合同履行期间同期中国人民银行贷款基准利率发生任何调整和变更的，本合同项下承租人应付租金的金额不做调整和变更，承租人仍应按照出租人发出的《起租通知书》与《租金支付表》向出租人支付租金。';\r\n");
      out.write("\t}else if(mini.get(\"adjuststyle\").getValue() == \"next_year\" || mini.get(\"adjuststyle\").getValue() == \"next_year_next_list\"){\r\n");
      out.write("\t\tparams[\"contract_rule.ratefloattype\"]='本合同实际起租后，如遇中国人民银行同期贷款基准利率调整的，出租人均有权参考调整后的中国人民银行同期贷款基准利率对租金金额进行同方向的变更，利率调整日之前各期租金和利率调整日后的第一期租金不变，之后各期租金开始按调整后的租金金额收取。出租人根据上述约定变更租金后，将向承租人发出《租金变更通知书》，承租人在此同意无条件接受本条所述租金变更并按照《租金变更通知书》向出租人支付租金。';\r\n");
      out.write("\t}else{\r\n");
      out.write("\t\tparams[\"contract_rule.ratefloattype\"]='本合同实际起租后，以后每年与起租日相同的日期为起租对应日。起租日下一年度的起租对应日与起租日相比或任何一年起租对应日与上一年度起租对应日相比，中国人民银行贷款基准利率发生变更的，出租人均有权参考变更后的中国人民银行同期贷款基准利率对租金金额进行同方向的变更。若出租人根据上述约定调整租金金额的，租金调整日之前各期租金不变，承租人应于该起租对应日支付的租金（若有）和该起租对应日之后应支付的第一期租金金额不变，以后各期租金开始按调整后的租金金额收取。出租人根据上述约定变更租金后，将向承租人发出《租金变更通知书》，承租人在此同意无条件接受本条所述租金变更并按照《租金变更通知书》向出租人支付租金。';\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tvar insuremoneytype=mini.get(\"rawValue_insuremoneytype\").getValue();\r\n");
      out.write("\tif(insuremoneytype=='本司付款'){\r\n");
      out.write("\t\tparams[\"contract_rule.insuremoneytype\"]='出租人自行购买租赁物保险';\r\n");
      out.write("\t}else if(insuremoneytype=='客户自保'){\r\n");
      out.write("\t\tparams[\"contract_rule.insuremoneytype\"]='承租人自行购买租赁物保险';\r\n");
      out.write("\t}else if(insuremoneytype=='代收代付'){\r\n");
      out.write("\t\tparams[\"contract_rule.insuremoneytype\"]='出租人代办租赁物保险';\r\n");
      out.write("\t}else{\r\n");
      out.write("\t\tparams[\"contract_rule.insuremoneytype\"]='无';\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif(mini.get('contract_info.industrytype').getValue()=='medical'){\r\n");
      out.write("\t\tparams['contract_rule.owncell']='我院';\r\n");
      out.write("\t}else{\r\n");
      out.write("\t\tparams['contract_rule.owncell']='我公司';\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tvar cautionmoneyremain=mini.get(\"cautionmoneyremain\").getValue().replace(regx,'');\r\n");
      out.write("\tif(parseFloat(cautionmoneyremain)>0){\r\n");
      out.write("\t\tparams['contract_rule.cautionmoneyremain']=',但起租后至租赁期满时若承租人无任何违约情况或虽存在违约但已全部得以救济，则出租人应于租赁期满后无息退还承租人租赁保证金。';\r\n");
      out.write("\t\tparams[\"contract_rule.cautiondeductionmoney\"]='';\r\n");
      out.write("\t}else{\r\n");
      out.write("\t\tparams['contract_rule.cautionmoneyremain']='';\r\n");
      out.write("\t\tparams[\"contract_rule.cautiondeductionmoney\"]='在承租人无任何违约或虽存在违约但已全部得以救济的情况下，租赁保证金将按其剩余金额倒序冲抵最后一期或多期租金的部分或全部，若剩余租赁保证金不足冲抵最后某期租金的全部，则承租人必须先行支付完毕不足部分，之后方能进行租赁保证金冲抵，承租人同意前述冲抵';\r\n");
      out.write("\t}\r\n");
      out.write("\tvar contract_guarantee_equip=mini.get('contract_guarantee_equip').getData();\r\n");
      out.write("\t\r\n");
      out.write("   if(params[\"templateid\"].match('40288dfd53a112710153a2b23570004f')){\r\n");
      out.write("\t   params['F-201603013']=mini.encode([{'contractnumber.contractno':generateContractNo('L',0)}]);\r\n");
      out.write("   }\r\n");
      out.write("\t\r\n");
      out.write("   if(params[\"templateid\"].match('40288dfd53a112710153a15efb7c0029')){\r\n");
      out.write("\t   params['F-201603012']=mini.encode([{'contractnumber.contractno':generateContractNo('L',0)}]);\r\n");
      out.write("   }\r\n");
      out.write("   params['contractnumber.maincontract']=generateContractNo('L',0);\r\n");
      out.write("   \r\n");
      out.write("    if(params[\"templateid\"].match('40288dfd53a639780153a725861c0054')){\r\n");
      out.write("\t\ttemp_arr=[];\r\n");
      out.write("\t\tvar count=0;\r\n");
      out.write("\t\tfor(var i=0;i<contract_guarantee_equip.length;i++){\r\n");
      out.write("\t\t\tif('guarantee_type1'==contract_guarantee_equip[i].equipguaranteetype||'guarantee_type3'==contract_guarantee_equip[i].equipguaranteetype){\r\n");
      out.write("\t\t   \t  temp_obj={};\r\n");
      out.write("\t\t   \t  temp_obj['guarantor']=contract_guarantee_equip[i].guarantor;\r\n");
      out.write("\t\t      temp_obj['contractnumber.contractno']=generateContractNo('G',count);\r\n");
      out.write("\t\t      temp_obj['contractnumber.maincontract']=generateContractNo('L',0);\r\n");
      out.write("\t\t      count++;\r\n");
      out.write("\t\t   \t  temp_obj['contract_guarantee_equip.equipname']=contract_guarantee_equip[i].equipname;\r\n");
      out.write("\t\t   \t  temp_obj['contract_guarantee_equip.guarantor']=contract_guarantee_equip[i].guarantor;\r\n");
      out.write("\t\t   \t  temp_obj['contract_guarantee_equip.guarantyvalue']=contract_guarantee_equip[i].guarantyvalue;\r\n");
      out.write("\t\t   \t  temp_arr.push(temp_obj);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tparams['F-201603014']=mini.encode(temp_arr);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif(params[\"templateid\"].match('40288dfd53a639780153a7cc09da0092')){\r\n");
      out.write("\t\ttemp_arr=[];\r\n");
      out.write("\t\tvar count=0;\r\n");
      out.write("\t\tfor(var i=0;i<contract_guarantee_equip.length;i++){\r\n");
      out.write("\t\t\tif('guarantee_type8'==contract_guarantee_equip[i].equipguaranteetype){\r\n");
      out.write("\t\t   \t  temp_obj={};\r\n");
      out.write("\t\t      temp_obj['contractnumber.contractno']=generateContractNo('G',count);\r\n");
      out.write("\t\t      temp_obj['contractnumber.maincontract']=generateContractNo('L',0);\r\n");
      out.write("\t\t      count++;\r\n");
      out.write("\t\t   \t  temp_obj['guarantor']=contract_guarantee_equip[i].guarantor;\r\n");
      out.write("\t\t   \t  temp_arr.push(temp_obj);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tparams['F-201603015']=mini.encode(temp_arr);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tvar contract_guarantee_method=mini.get(\"contract_guarantee_method\").getData();\r\n");
      out.write("\t\r\n");
      out.write("\tif(params[\"templateid\"].match('40288dfd53a639780153a7edd4a7009a')){\r\n");
      out.write("\t\ttemp_arr=[];\r\n");
      out.write("\t\tvar count=0;\r\n");
      out.write("\t\tfor(var i=0;i<contract_guarantee_method.length;i++){\r\n");
      out.write("\t\t\tif('CUST_INFO_COMPANY'!=contract_guarantee_method[i].assurorcustclass){\r\n");
      out.write("\t\t\t  temp_obj={};\r\n");
      out.write("\t\t\t   temp_obj['contractnumber.contractno']=generateContractNo('G',count);\r\n");
      out.write("\t\t\t   temp_obj['contractnumber.maincontract']=generateContractNo('L',0);\r\n");
      out.write("\t\t\t   count++;\r\n");
      out.write("\t\t   \t  temp_obj['assuror']=contract_guarantee_method[i].assuror;\r\n");
      out.write("\t\t   \t  temp_arr.push(temp_obj);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tparams['F-201603016']=mini.encode(temp_arr);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif(params[\"templateid\"].match('40288dfd53a639780153a811be6b00b3')){\r\n");
      out.write("\t\ttemp_arr=[];\r\n");
      out.write("\t\tvar count=0;\r\n");
      out.write("\t\tfor(var i=0;i<contract_guarantee_method.length;i++){\r\n");
      out.write("\t\t\tif('CUST_INFO_COMPANY'==contract_guarantee_method[i].assurorcustclass){\r\n");
      out.write("\t\t\t  temp_obj={};\r\n");
      out.write("\t\t\t   temp_obj['contractnumber.contractno']=generateContractNo('G',count);\r\n");
      out.write("\t\t\t   temp_obj['contractnumber.maincontract']=generateContractNo('L',0);\r\n");
      out.write("\t\t\t   count++;\r\n");
      out.write("\t\t   \t  temp_obj['assuror']=contract_guarantee_method[i].assuror;\r\n");
      out.write("\t\t   \t  temp_arr.push(temp_obj);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tparams['F-201603017']=mini.encode(temp_arr);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tvar contract_supplier = mini.get('contract_supplier').getData();\r\n");
      out.write("\tvar fund_plan=mini.get(\"fund_fund_plan\").getData();\r\n");
      out.write("\tif (params[\"templateid\"].match('40288dfd53ab59430153aba739540014')) {\r\n");
      out.write("\t\ttemp_arr = [];\r\n");
      out.write("\t\tfor (var i = 0; i < contract_supplier.length; i++) {\r\n");
      out.write("\t\t\ttemp_obj = {};\r\n");
      out.write("\t\t\tif (contract_supplier[i].vndrtype == 'vndr_type.import') {\r\n");
      out.write("\t\t\t\tvar totalequipprice = 0;\r\n");
      out.write("\t\t\t\ttemp_obj[\"contractnumber.contractno\"] = generateContractNo('I',i);\r\n");
      out.write("\t\t\t\ttemp_obj[\"seller\"] = contract_supplier[i].seller;\r\n");
      out.write("\t\t\t\tvar contract_equip_temp_arr = [];\r\n");
      out.write("\t\t\t\tfor (var j = 0; j < contract_equip.length; j++) {\r\n");
      out.write("\t\t\t\t\tif (contract_equip[j].vndr == contract_supplier[i].seller) {\r\n");
      out.write("\t\t\t\t\t\tvar contract_equip_temp_obj = {};\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipname = contract_equip[i].equipname;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.model = contract_equip[i].model;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipnum = contract_equip[i].equipnum;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.price = contract_equip[i].price;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipdeliveryplace = contract_equip[i].equipdeliveryplace;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.vndrname = contract_equip[i].vndrname;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipdeliverydate = contract_equip[i].equipdeliverydate;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipplace = contract_equip[i].equipplace;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_arr.push(contract_equip_temp_obj);\r\n");
      out.write("\t\t\t\t\t\ttotalequipprice+=parseFloat(contract_equip[i].price.replace(regx,''));\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\tvar collection_count=0;\r\n");
      out.write("\t\t\t\tfor(var k=0;k<fund_plan.length;k++){\r\n");
      out.write("\t\t\t\t\tif(fund_plan[k].feetypename=='设备款'&&fund_plan[k].paycust==contract_supplier[i].seller){\r\n");
      out.write("\t\t\t\t\t\tcollection_count++;\r\n");
      out.write("\t\t\t\t\t\tif(collection_count==1){\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.first']=fund_plan[k].planmoney;\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.dxfirst']=DX(fund_plan[k].planmoney);\r\n");
      out.write("\t\t\t\t\t\t}else if(collection_count==2){\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.second']=fund_plan[k].planmoney;\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.dxsecond']=DX(fund_plan[k].planmoney);\r\n");
      out.write("\t\t\t\t\t\t}else if(collection_count==3){\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.third']=fund_plan[k].planmoney;\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.dxthird']=DX(fund_plan[k].planmoney);\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t        temp_obj['contract_equip_list']=mini.encode(contract_equip_temp_arr);\r\n");
      out.write("\t\t        temp_obj['contract_equip_list_info.totalequipprice']=DX(totalequipprice);\r\n");
      out.write("\t\t        temp_arr.push(temp_obj);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tparams['F-201603018']=mini.encode(temp_arr);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif (params[\"templateid\"].match('40288dfd53ab59430153acc20db70047')) {\r\n");
      out.write("\t\ttemp_arr = [];\r\n");
      out.write("\t\tfor (var i = 0; i < contract_supplier.length; i++) {\r\n");
      out.write("\t\t\ttemp_obj = {};\r\n");
      out.write("\t\t\tif(mini.get('contract_info.industrytype').getValue()!='medical'){\r\n");
      out.write("\t\t\tif (contract_supplier[i].vndrtype != 'vndr_type.import') {\r\n");
      out.write("\t\t\t\tvar totalequipprice = 0;\r\n");
      out.write("\t\t\t\ttemp_obj[\"contractnumber.contractno\"] = generateContractNo('P',i);\r\n");
      out.write("\t\t\t\ttemp_obj[\"seller\"] = contract_supplier[i].seller;\r\n");
      out.write("\t\t\t\tvar contract_equip_temp_arr = [];\r\n");
      out.write("\t\t\t\tfor (var j = 0; j < contract_equip.length; j++) {\r\n");
      out.write("\t\t\t\t\tif (contract_equip[j].vndr == contract_supplier[i].seller) {\r\n");
      out.write("\t\t\t\t\t\tvar contract_equip_temp_obj = {};\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipname = contract_equip[i].equipname;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.model = contract_equip[i].model;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipnum = contract_equip[i].equipnum;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.price = contract_equip[i].price;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipdeliveryplace = contract_equip[i].equipdeliveryplace;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.vndrname = contract_equip[i].vndrname;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipdeliverydate = contract_equip[i].equipdeliverydate;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipplace = contract_equip[i].equipplace;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_arr.push(contract_equip_temp_obj);\r\n");
      out.write("\t\t\t\t\t\ttotalequipprice+=parseFloat(contract_equip[i].price.replace(regx,''));\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tvar collection_count=0;\r\n");
      out.write("\t\t\t\tfor(var k=0;k<fund_plan.length;k++){\r\n");
      out.write("\t\t\t\t\tif(fund_plan[k].feetypename=='设备款'&&fund_plan[k].paycust==contract_supplier[i].seller){\r\n");
      out.write("\t\t\t\t\t\tcollection_count++;\r\n");
      out.write("\t\t\t\t\t\tif(collection_count==1){\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.first']=fund_plan[k].planmoney;\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.dxfirst']=DX(fund_plan[k].planmoney);\r\n");
      out.write("\t\t\t\t\t\t}else if(collection_count==2){\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.second']=fund_plan[k].planmoney;\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.dxsecond']=DX(fund_plan[k].planmoney);\r\n");
      out.write("\t\t\t\t\t\t}else if(collection_count==3){\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.third']=fund_plan[k].planmoney;\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.dxthird']=DX(fund_plan[k].planmoney);\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t        temp_obj['contract_equip_list']=mini.encode(contract_equip_temp_arr);\r\n");
      out.write("\t\t        temp_obj['contract_equip_list_info.totalequipprice']=DX(totalequipprice);\r\n");
      out.write("\t\t        temp_arr.push(temp_obj);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tparams['F-201603014']=mini.encode(temp_arr);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif (params[\"templateid\"].match('40288dfd53ab59430153acfa480b005f')) {\r\n");
      out.write("\t\ttemp_arr = [];\r\n");
      out.write("\t\tfor (var i = 0; i < contract_supplier.length; i++) {\r\n");
      out.write("\t\t\ttemp_obj = {};\r\n");
      out.write("\t\t\tif(mini.get('contract_info.industrytype').getValue()=='medical'){\r\n");
      out.write("\t\t\tif (contract_supplier[i].vndrtype != 'vndr_type.import') {\r\n");
      out.write("\t\t\t\tvar totalequipprice = 0;\r\n");
      out.write("\t\t\t\ttemp_obj[\"contractnumber.contractno\"] = generateContractNo('P',i);\r\n");
      out.write("\t\t\t\ttemp_obj[\"seller\"] = contract_supplier[i].seller;\r\n");
      out.write("\t\t\t\tvar contract_equip_temp_arr = [];\r\n");
      out.write("\t\t\t\tfor (var j = 0; j < contract_equip.length; j++) {\r\n");
      out.write("\t\t\t\t\tif (contract_equip[j].vndr == contract_supplier[i].seller) {\r\n");
      out.write("\t\t\t\t\t\tvar contract_equip_temp_obj = {};\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipname = contract_equip[i].equipname;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.model = contract_equip[i].model;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipnum = contract_equip[i].equipnum;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.price = contract_equip[i].price;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipdeliveryplace = contract_equip[i].equipdeliveryplace;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.vndrname = contract_equip[i].vndrname;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipdeliverydate = contract_equip[i].equipdeliverydate;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipplace = contract_equip[i].equipplace;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_arr.push(contract_equip_temp_obj);\r\n");
      out.write("\t\t\t\t\t\ttotalequipprice+=parseFloat(contract_equip[i].price.replace(regx,''));\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\tvar collection_count=0;\r\n");
      out.write("\t\t\t\tfor(var k=0;k<fund_plan.length;k++){\r\n");
      out.write("\t\t\t\t\tif(fund_plan[k].feetypename=='设备款'&&fund_plan[k].paycust==contract_supplier[i].seller){\r\n");
      out.write("\t\t\t\t\t\tcollection_count++;\r\n");
      out.write("\t\t\t\t\t\tif(collection_count==1){\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.first']=fund_plan[k].planmoney;\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.dxfirst']=DX(fund_plan[k].planmoney);\r\n");
      out.write("\t\t\t\t\t\t}else if(collection_count==2){\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.second']=fund_plan[k].planmoney;\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.dxsecond']=DX(fund_plan[k].planmoney);\r\n");
      out.write("\t\t\t\t\t\t}else if(collection_count==3){\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.third']=fund_plan[k].planmoney;\r\n");
      out.write("\t\t\t\t\t\t\ttemp_obj['equip_plan.dxthird']=DX(fund_plan[k].planmoney);\r\n");
      out.write("\t\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t        temp_obj['contract_equip_list']=mini.encode(contract_equip_temp_arr);\r\n");
      out.write("\t\t        temp_obj['contract_equip_list_info.totalequipprice']=DX(totalequipprice);\r\n");
      out.write("\t\t        temp_arr.push(temp_obj);\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tparams['F-201603020']=mini.encode(temp_arr);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif (params[\"templateid\"].match('40288d0653bad5490153bae8afba0011')) {\r\n");
      out.write("\t\tparams['F-201603023']=mini.encode([{'contractnumber.contractno':generateContractNo('C',0)}]);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif (params[\"templateid\"].match('40288d0653bad5490153bb073b130019')) {\r\n");
      out.write("\t\tparams['F-201603024']=mini.encode([{'contractnumber.contractno':generateContractNo('C',0)}]);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif (params[\"templateid\"].match('40288d0653bad5490153bbdaebe9005f')) {\r\n");
      out.write("\t\ttemp_arr=[];\r\n");
      out.write("\t\tfor(var i=0;i<contract_guarantee_method.length;i++){\r\n");
      out.write("\t\t\t  temp_obj={};\r\n");
      out.write("\t\t\t  temp_obj['contractnumber.maincontract']=generateContractNo('L',0);\r\n");
      out.write("\t\t   \t  temp_obj['assuror']=contract_guarantee_method[i].assuror;\r\n");
      out.write("\t\t   \t  temp_arr.push(temp_obj);\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tparams['F-201603026']=mini.encode(temp_arr);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif (params[\"templateid\"].match('40288d0653bad5490153bbf28490006d')) {\r\n");
      out.write("\t\ttemp_arr=[];\r\n");
      out.write("\t\tfor(var i=0;i<contract_guarantee_method.length;i++){\r\n");
      out.write("\t\t\t  temp_obj={};\r\n");
      out.write("\t\t\t  temp_obj['contractnumber.maincontract']=generateContractNo('L',0);\r\n");
      out.write("\t\t   \t  temp_obj['assuror']=contract_guarantee_method[i].assuror;\r\n");
      out.write("\t\t   \t  temp_arr.push(temp_obj);\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tparams['F-201603028']=mini.encode(temp_arr);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif (params[\"templateid\"].match('40288d0653bad5490153bbf3c640006f')) {\r\n");
      out.write("\t\ttemp_arr=[];\r\n");
      out.write("\t\tfor(var i=0;i<contract_guarantee_method.length;i++){\r\n");
      out.write("\t\t\t  temp_obj={};\r\n");
      out.write("\t\t\t  temp_obj['contractnumber.maincontract']=generateContractNo('L',0);\r\n");
      out.write("\t\t   \t  temp_obj['assuror']=contract_guarantee_method[i].assuror;\r\n");
      out.write("\t\t   \t  temp_arr.push(temp_obj);\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tparams['F-201603030']=mini.encode(temp_arr);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif (params[\"templateid\"].match('40288d0653bad5490153bc42af720096')) {\r\n");
      out.write("\t\ttemp_arr = [];\r\n");
      out.write("\t\tfor (var i = 0; i < contract_supplier.length; i++) {\r\n");
      out.write("\t\t\t   temp_obj = {};\r\n");
      out.write("\t\t\t   var no=0;\r\n");
      out.write("\t\t\t   var totalequipprice=0;\r\n");
      out.write("\t\t\t   var contract_equip_temp_arr = [];\r\n");
      out.write("\t\t\t\tfor (var j = 0; j < contract_equip.length; j++) {\r\n");
      out.write("\t\t\t\t\ttemp_obj[\"seller\"] = contract_supplier[i].seller;\r\n");
      out.write("\t\t\t\t\tif (contract_equip[j].vndr == contract_supplier[i].seller) {\r\n");
      out.write("\t\t\t\t\t\tvar contract_equip_temp_obj = {};\r\n");
      out.write("\t\t\t\t\t\tno++;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.no=no;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipname = contract_equip[i].equipname;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.model = contract_equip[i].model;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipnum = contract_equip[i].equipnum;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.manufacturername = contract_equip[i].manufacturername;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_obj.equipid = contract_equip[i].equipid;\r\n");
      out.write("\t\t\t\t\t\tcontract_equip_temp_arr.push(contract_equip_temp_obj);\r\n");
      out.write("\t\t\t\t\t\ttotalequipprice+=parseFloat(contract_equip[i].price.replace(regx,''));\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t }\r\n");
      out.write("\t\t\t      temp_obj['contract_equip_list']=mini.encode(contract_equip_temp_arr);\r\n");
      out.write("\t\t\t      temp_obj['contract_equip_list_info.totalequipprice']=DX(totalequipprice);\r\n");
      out.write("\t\t\t      temp_arr.push(temp_obj);\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tparams['F-201603032']=mini.encode(temp_arr);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif (params[\"templateid\"].match('40288d0653bad5490153bc67e3cb00a3')) {\r\n");
      out.write("\t\ttemp_arr = [];\r\n");
      out.write("\t\tfor (var i = 0; i < contract_supplier.length; i++) {\r\n");
      out.write("\t\t\tvar equipamt_count=0;\r\n");
      out.write("\t\t\t\tfor(var k=0;k<fund_plan.length;k++){\r\n");
      out.write("\t\t\t\t\tif(fund_plan[k].feetypename=='设备款'&&fund_plan[k].paycust==contract_supplier[i].seller){\r\n");
      out.write("\t\t\t\t\t\ttemp_obj = {};\r\n");
      out.write("\t\t\t\t\t\tequipamt_count++;\r\n");
      out.write("\t\t\t\t\t\ttemp_obj[\"seller\"] = contract_supplier[i].seller;\r\n");
      out.write("\t\t\t\t\t\tcollection_count++;\r\n");
      out.write("\t\t\t\t\t\ttemp_obj['equip_amt.planmoney']=fund_plan[k].planmoney;\r\n");
      out.write("\t\t\t\t\t\ttemp_obj['equip_amt.term']='请贵司待购买合同中第'+equipamt_count+'笔购买款 ';\r\n");
      out.write("\t\t\t\t\t\ttemp_arr.push(temp_obj);\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tparams['F-201603034']=mini.encode(temp_arr);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif (params[\"templateid\"].match('40288d0653bad5490153bc8d7b1300b5')) {\r\n");
      out.write("\t\tparams['lastequipamt.lastequipamt']=decimal(parseFloat(params[\"contract_condition.equipamt\"])-parseFloat(params[\"contract_condition.cautionmoney\"])-parseFloat(params[\"contract_condition.handlingchargemoney\"]),2);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif (params[\"templateid\"].match('40288d0653bad5490153bcd4b72300d9')) {\r\n");
      out.write("\t\ttemp_arr = [];\r\n");
      out.write("\t\tfor (var i = 0; i < contract_supplier.length; i++) {\r\n");
      out.write("\t\t\t\tfor(var k=0;k<fund_plan.length;k++){\r\n");
      out.write("\t\t\t\t\tif(fund_plan[k].feetypename=='设备款'&&fund_plan[k].paycust==contract_supplier[i].seller){\r\n");
      out.write("\t\t\t\t\t\ttemp_obj = {};\r\n");
      out.write("\t\t\t\t\t\ttemp_obj[\"seller\"] = contract_supplier[i].seller;\r\n");
      out.write("\t\t\t\t\t\ttemp_obj['first_equip.planmoney']=fund_plan[k].planmoney;\r\n");
      out.write("\t\t\t\t\t\ttemp_arr.push(temp_obj);\r\n");
      out.write("\t\t\t\t\t\tbreak;\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\tparams['F-201603037']=mini.encode(temp_arr);\r\n");
      out.write("\t}\r\n");
      out.write("\t\r\n");
      out.write("\tif (params[\"templateid\"].match('40288ded53cb135f0153cb32fd1d000f')) {\r\n");
      out.write("\t\ttemp_arr = [];\r\n");
      out.write("\t\tfor(var i=0;i<contract_supplier.length;i++){\r\n");
      out.write("\t\t\ttemp_obj={};\r\n");
      out.write("\t\t\ttemp_obj['seller_info.sellername']=contract_supplier[i].sellername;\r\n");
      out.write("\t\t\ttemp_obj['contractnumber.contractno']=generateContractNo('F',i);\r\n");
      out.write("\t\t\ttemp_obj['contractnumber.advno']=generateContractNo('C',i);\r\n");
      out.write("\t\t\tfor(var k=0;k<fund_plan.length;k++){\r\n");
      out.write("\t\t\t\tvar pay_count=0;\r\n");
      out.write("\t\t\t\tif(fund_plan[k].feetypename=='设备款'&&fund_plan[k].paycust==contract_supplier[i].seller){\r\n");
      out.write("\t\t\t\t\tpay_count++;\r\n");
      out.write("\t\t\t\t\tif(pay_count==1){\r\n");
      out.write("\t\t\t\t\t\ttemp_obj['pay_condition.firstpay']=fund_plan[k].planmoney;\r\n");
      out.write("\t\t\t\t\t\ttemp_obj['pay_condition.dxfirstpay']=DX(fund_plan[k].planmoney);\r\n");
      out.write("\t\t\t\t\t}else if(pay_count==2){\r\n");
      out.write("\t\t\t\t\t\ttemp_obj['pay_condition.secondpay']=fund_plan[k].planmoney;\r\n");
      out.write("\t\t\t\t\t\ttemp_obj['pay_condition.dxsecondpay']=DX(fund_plan[k].planmoney);\r\n");
      out.write("\t\t\t\t\t}\r\n");
      out.write("\t\t\t\t}\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t\ttemp_arr.push(temp_obj);\r\n");
      out.write("\t\t}\r\n");
      out.write("\t  params['F-201603046']=mini.encode(temp_arr);\r\n");
      out.write("\t}\r\n");
      out.write("\tif (params[\"templateid\"].match('40288ded53cb135f0153cc05bd00002e')) {\r\n");
      out.write("\t\tparams['F-201603047']=mini.encode([{'contractnumber.contractno':generateContractNo('F',0)}]);\r\n");
      out.write("\t}\r\n");
      out.write("\t//console.info(params);\r\n");
      out.write("\t\r\n");
      out.write("}\r\n");
      out.write("function generateContractNo(mark,count){\r\n");
      out.write("\tvar level1=\"\";\r\n");
      out.write("\tcount++;\r\n");
      out.write("\tvar level2=mark;\r\n");
      out.write("\tvar contract_number=mini.getbyName('contract_info.contractid').getValue().replace('P','');\r\n");
      out.write("\tvar level3=contract_number.split('-')[0];\r\n");
      out.write("\tif(mini.getbyName('contract_info.businesstype').getValue()=='business_type.factoring'){\r\n");
      out.write("\t\tlevel1='F';\r\n");
      out.write("\t}else{\r\n");
      out.write("\t\tvar industrytype=mini.get(\"contract_info.industrytype\").getValue();\r\n");
      out.write("\t\tif(industrytype=='medical'){\r\n");
      out.write("\t\t\tlevel1='H';\r\n");
      out.write("\t\t}else if(industrytype=='Pharma'){\r\n");
      out.write("\t\t\tlevel1='P';\r\n");
      out.write("\t\t}else{\r\n");
      out.write("\t\t\tlevel1='S';\r\n");
      out.write("\t\t}\r\n");
      out.write("\t}\r\n");
      out.write("\treturn level1+level2+level3+\"-\"+count;\r\n");
      out.write("}\r\n");
      out.write("</script>\r\n");
      out.write("<div id=\"id_tasksContainer2\" style=\"width: 100%;height: 100%;\"></div>\r\n");
      out.write("<table class=\"fillTable\" cellspacing=\"0\" cellpadding=\"0\" id=\"id_table_generate_contract\">\r\n");
      out.write("\t<tr class=\"tr-odd\">\r\n");
      out.write("\t\t<td class=\"td-content-title\" width=\"12%\">合同文本类型：</td>\r\n");
      out.write("\t\t<td class=\"td-content\" width=\"38%\" style=\"text-indent: 0px;\" colspan=\"2\">\r\n");
      out.write("\t\t\t<input name=\"twoclassify\" id=\"twoclassify\" \r\n");
      out.write("\t\t\t\tclass=\"mini-combobox\"\r\n");
      out.write("\t\t\t\tdataField=\"datas\"\r\n");
      out.write("\t\t\t\ttextField=\"name\"\r\n");
      out.write("\t\t\t\tvalueField=\"code\"\r\n");
      out.write("\t\t\t\tshowNullItem=\"true\"\r\n");
      out.write("\t\t\t\tonvaluechanged=\"reloadNextClassify(e,'twoclassify','threeclassify')\"\r\n");
      out.write("\t\t\t\ttext=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['rawValue_twoclassify']}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\"\r\n");
      out.write("\t\t\t\tvalue=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['twoclassify']}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\">\r\n");
      out.write("\t\t\t<input id=\"rawValue_twoclassify\" name=\"rawValue_twoclassify\" value=\"");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${requestScope['rawValue_twoclassify']}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("\" class=\"mini-textbox\" style=\"display:none\"/>\r\n");
      out.write("\t\t</td>\r\n");
      out.write("\t\t<td class=\"td-content-title\"  style=\"text-indent: 0px;\">\r\n");
      out.write("\t\t\t<a id=\"create_contract_word\" class=\"mini-button\" iconCls=\"icon-new\" onclick=\"createContractWord()\" style=\"color: red;font-weight: bold;\">相关合同</a>\r\n");
      out.write("\t\t</td>\r\n");
      out.write("\r\n");
      out.write("\t</tr>\r\n");
      out.write("\t");
      out.write('\r');
      out.write('\n');
      out.write("\r\n");
      out.write("</table>\r\n");
      out.write("\r\n");
      out.write("<table class=\"fillTable\" cellspacing=\"0\" cellpadding=\"0\">\r\n");
      out.write("\t<tr class=\"tr-even\" id=\"id_word_tips\">\r\n");
      out.write("\t\t<td class=\"td-content-title\">合同模板：</td>\r\n");
      out.write("\t\t<td class=\"td-content\" colspan=\"3\"><div style=\"overflow:hidden;width:100%;\" id=\"contract_word_check_list\">请先选择!</div></td>\r\n");
      out.write("\t</tr>\r\n");
      out.write("\t<tr class=\"tr-contractect-word-list\">\r\n");
      out.write("\t\t<td class=\"td-content\" colspan=\"4\">\r\n");
      out.write("\t\t\t");
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "contract_list_info.jsp", out, false);
      out.write("\r\n");
      out.write("\t\t</td>\r\n");
      out.write("\t</tr>\r\n");
      out.write("</table>\r\n");
      out.write("\r\n");
      out.write("<script language=\"javascript\">\r\n");
      out.write("jQuery(function(){chargeTemplate()});\r\n");
      out.write("jQuery(function(){\r\n");
      out.write("\tif('");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.isView}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("' == 'true' || isViewHistoryTask==true){\r\n");
      out.write("\t\t$(\"#id_table_generate_contract\").hide();\r\n");
      out.write("\t\t$(\"#id_word_tips\").hide();\r\n");
      out.write("\t};\r\n");
      out.write("})\r\n");
      out.write("</script>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
